{
  "#type": "chain",
  "chain": [
    {
      "#type": "merge",
      "values": [
        "$.results.datasets.elasticsearch",
        "$.results.datasets.elasticsearchEtna",
        "$.aggs.datasets.elasticsearch",
        "$.aggs.datasets.elasticsearchEtna",
        {
          "stats": "$.results.stats"
        },
        {
          "aggregations": "$.aggs.datasets.elasticsearch.aggregations"
        },
        {
          "aggregations": "$.aggs.datasets.elasticsearchEtna.aggregations"
        }
      ]
    },
    {
      "data": {
        "#type": "fallback",
        "strategies": [
          {
            "#type": "as_list",
            "values": {
              "#type": "for_each",
              "values": "$.data",
              "spec": "$.data"
            }
          },
          []
        ]
      },
      "errors": {
        "#type": "fallback",
        "strategies": [
          {
            "#type": "as_list",
            "values": {
              "#type": "flatten",
              "values": [
                "$$.results.errors",
                "$$.aggs.errors",
                "$$.results.datasets.elasticsearch.errors",
                "$$.aggs.datasets.elasticsearch.errors"
              ]
            }
          },
          []
        ]
      },
      "aggregations": {
        "#type": "fallback",
        "strategies": [
          {
            "#type": "as_list",
            "values": "$.aggregations"
          },
          []
        ]
      },
      "stats": {
        "total": "$.stats.total",
        "results": "$$.results.stats.results",
        "providers": "$.stats.providers",
        "latency": {
          "#type": "chain",
          "chain": [
            {
              "#type": "as_list",
              "values": [
                "$$.results.stats.latency",
                "$$.aggs.stats.latency"
              ]
            },
            "$.sum()"
          ]
        }
      },
      "found": "$.found"
    }
  ]
}